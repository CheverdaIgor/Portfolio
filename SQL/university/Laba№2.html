<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>СУБД MS SQL </TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content="MSHTML 5.50.4134.600" name=GENERATOR></HEAD>
<BODY style="background:lightgreen">
<CENTER>
<H3>Лабораторная работа №2</H3></CENTER>
<HR>
<P>  <CENTER><DT><font size="4"><B>Работа с базой данных из Query Analyzer</B> </font></P></CENTER>
<P>
<DL>

  <DT><B>Цель работы:</B> научиться создавать, изменять, заполнять, удалять таблицы из <I><B> Query Analyzer</B></I>, создавать SQL-запросы, уметь работать с представлениями  <I><B>(View)</B></I> в MS SQL</DT>.<BR><BR>

    <CENTER><DT><font size="4"><B>  </B></font> </P></CENTER>

 <P>  <CENTER><DT><font size="4"><B>Порядок выполнения работы:</B> </font></P></CENTER>

   <DD>
   <OL>
   <LI>Открыть окно <I><B> Query Analyzer</B></I>, подсоединившись к серверу <b>TEYA</b> и использовав Windows-аутентификацию.
   <LI>С  помощью команды <I><B>CREATE TABLE </B></I> в своей базе данных создать таблицу <I><B>Workers</B></I> со следующей структурой:<BR>
       <UL>
         <LI>kod типа int ключевое поле;
         <LI>name типа char(50);
         <LI>salary типа numeric(11,2);
        </UL>
     
       <LI>Изменить структуру таблицы <I><B>Workers</B></I> при помощи команды <I><B>ALTER TABLE </B></I> следующим образом: добавить к уже созданной таблице поле Data (дата приема на работу). <BR>
 
      <LI>Заполнить таблицу <I><B>Workers</B></I> данными (не менее 7-ми записей) с помощью команды <I><B> INSERT INTO </B></I>

     <LI>Пользуясь командой <I><B> DELETE FROM ... WHERE ...</B></I>, удалить записи, удовлетворяющие поставленным Вами условиям (например, записи о сотрудниках, дата приема которых на работу раньше 10.10.1965 г.).

     <LI>Командой <I><B> UPDATE ... WHERE ...</B></I> изменить данные в таблице (например, увеличить зарплату тем сотрудникам, которые работают с 10.10.1970 г.)

	<LI>Очистить таблицу с помощью команды <I><B> TRUNCATE TABLE </B></I>.

      <LI> Удалить ранее созданную таблицу <I><B>Workers</B></I> командой <I><B> DROP TABLE </B></I> .
     
<LI> В <I><B> Query Analyzer</B></I> создать несколько выборок (SELECT-ов) из существующих в Вашей базе данных таблиц: 
    <UL>
         <LI>простой SELECT (например, отобразить наименования всех изделий, которыми торгует Ваша фирма);
         <LI> выборку с опцией DISTINCT для отображения неповторяющихся записей (записями считаются строки таблицы, которые могут состоять как из значения одного поля, так и с значений нескольких полей);
         <LI>выборки с разными типами объединения (INNER JOIN/OUTER JOIN), для чего используйте хотя бы две таблицы (например, таблицу Materials и Stuff ).
     <LI> выборку с подзапросом (это выборка с условием, для выполнения которого нужно организовать еще одну внутреннюю выборку);
    <LI> выборку данных с объединением ( UNION ) данных из двух SELECT-ов;
    <LI> выборку данных с группировкой ( GROUP BY ) и использованием функций AVG, COUNT, MAX, MIN, SUM.
</UL>     

   <LI> В <I><B>Enterprise Manager</B></I> создать 3 представления: на базе SQL-запроса из нескольких связанных таблиц с условием; на базе Union-запроса из двух таблиц; на базе SQL-запроса из нескольких связанных таблиц с группировкой данных.

   <LI> Для создания представления нужно на закладке <I><B> Views </B></I> Вашей базы данных вызвать контекстное меню, в нем выбрать команду <I><B> New View... </B></I> и в окне редактора представлений указать параметры представления: 
 <UL>
	<LI>Вызвав контекстное меню на панели diagram с помощью команды <I><B>Add Table...</B></I> укажите таблицы либо представления, данные из которых попадут в выборку и нажмите <B>Add</B> .</li>

	<LI>В полях столбца <B>Column</B> grid-панели выберите столбцы, на которые будет ссылаться представление. Выбор столбцов также можно осуществить, указав флажками необходимые поля на панели diagram. </li>
        <LI>В столбце <B>Alias</B> можете задать подпись столбца в результирующем наборе данных.

	<LI>В столбце <B>Output</B> укажите, будет ли отображаться столбец в результирующем наборе данных.</li>

	<LI>Для организации группировки по столбцу нужно вызвать контекстное меню на нем и затем выбрать команду <B>Group By</B>.</li>

	<LI>В колонке <B>Criteria</B> введите критерий отбора строк, который будет использоваться при отборе данных для Вашей выборки ( это условие WHERE, либо условие HAVING если имеет место группировка ). </li>

	<LI>В колонке <B>Or</B> можно указать дополнительные условия отбора строк.</li>

	<LI>При вызове контекстного меню на панели grid и выполнения команды <B>Properties</B> можно указать дополнительные параметры представления: <B>DISTINCT values </B> - для фильтрации повторяющихся значений результирующего набора данных; <B>Encrypt view</B> - для шифрования определения представления; <B>Top</B> - для указания количества либо процентной части (PERCENT) отображаемого в  результирующем наборе количества строк. </li>
</UL>
	<LI>Для выполнения представления (чтобы получить результирующий набор данных) воспользуйтесь командой <B>Run</B> из контекстного меню либо кнопкой на панели инструментов.

        <LI>Оформите Ваши представления <B>(для последующей защиты лабораторной работы!) </B>в виде отчета по лабораторной работе. командой <B>Save</B> из контекстного меню либо воспользовавшись кнопкой на панели инструментов.</li>


   </DD> </OL>

 <BR>
 <BR>
  </BODY></HTML>
